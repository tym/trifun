jQuery(function(a){a(".tips").tipTip({attribute:"data-tip",fadeIn:50,fadeOut:50,delay:0});a(".tips-top").tipTip({attribute:"data-tip",fadeIn:50,fadeOut:50,delay:0,defaultPosition:"top"});a(".yith-wcmbs-tabs").tabs();a(".yith-wcmbs-chosen").chosen({width:"100%"});a(".yith-wcmbs-color-picker").wpColorPicker();a(".yith-wcmbs-date").datepicker({dateFormat:"yy-mm-dd"});var h=a("#yith-wcmbs-delay-time-for-plans-container"),f=a("#yith-wcmbs-hide-contents"),k=a("#yith-wcmbs-redirect-link").closest("tr"),
g=a("#yith-wcmbs-products-in-membership-management"),l=a("#yith-wcmbs-download-link-position").closest("tr"),m=a("#yith-wcmbs-hide-price-and-add-to-cart").closest("tr"),n=function(){1>a(".yith-wcmbs-delay-number-input").length?h.hide():h.show()},p=a("#yith_wcmbs_restrict_access_plan");p.on("change",function(){var b=h.find("tr.yith-wcmbs-delay-row"),c=a(this).val(),d=[];b.each(function(){var b=a(this).data("plan-id")+"";d.push(b);(null==c||0>c.indexOf(b))&&a(this).remove()});for(var q in c)if(0==d.length||
0<d.length&&0>d.indexOf(c[q])){var b=c[q],e=p.find('option[value="'+b+'"]').html();h.append('<tr class="yith-wcmbs-delay-row" data-plan-id="'+b+'"><td><label for="yith-wcmbs-delay-'+b+'">'+e+'</label></td><td><input class="yith-wcmbs-delay-number-input" data-plan-id="'+b+'" id="yith-wcmbs-delay-'+b+'" name="_yith_wcmbs_plan_delay['+b+']" type="number" value="0" min="0"></td></tr>')}n()});n();f.on("change",function(){2==a(this)[0].selectedIndex?k.show():k.hide()});f.trigger("change");g.on("change",
function(){1==a(this)[0].selectedIndex?(l.show(),m.show()):(l.hide(),m.hide())});g.trigger("change");var e=a("#yith-wcmbs-plan-item-order-container"),f=e.find("li").get(),g=a("#yith-wcmbs-plan-item-text"),r={message:null,overlayCSS:{background:"#000",opacity:.6},ignoreIfBlocked:!0};f.sort(function(b,c){var d=parseInt(a(b).attr("rel")),e=parseInt(a(c).attr("rel"));return d<e?-1:d>e?1:0});a(f).each(function(b,a){e.append(a)});e.sortable({items:"li",cursor:"move",scrollSensitivity:40,forcePlaceholderSize:!0,
helper:"clone",opacity:.8,revert:!0,stop:function(b,a){a.item.hasClass("yith-wcmbs-plan-item-text")&&a.item.find("input").focus()}});g.draggable({connectToSortable:"#yith-wcmbs-plan-item-order-container",helper:"clone",revert:"invalid",stop:function(a,c){c.helper.html('<input type="text" name="_yith_wcmbs_plan_items[]" /><span class="dashicons dashicons-no-alt close"></span>');c.helper.css({height:"auto"})}});e.on("click",".close",function(b){a(b.target).closest("li").remove()});e.find("li").disableSelection();
g.disableSelection();e.on("click",".yith-wcmbs-delete-from-plan",function(b){var c=a(b.target),d=c.closest("li");b=c.data("post-id");c=c.data("plan-id");d.block(r);a.ajax({url:ajaxurl,type:"POST",data:{action:"yith_wcmbs_remove_plan_for_post",post_id:b,plan_id:c},success:function(a){console.log(a);d.unblock();d.remove()}})});e.on("click",".yith-wcmbs-hide-show-item",function(b){b=a(b.target);var c=b.closest("li").children("input.yith_wcmbs_hidden_item_ids");b.data("post-id");var d="show";b.is(".dashicons-visibility")&&
(d="hide");"show"==d?(c.prop("disabled",!0),b.removeClass("dashicons-hidden").addClass("dashicons-visibility")):(c.prop("disabled",!1),b.removeClass("dashicons-visibility").addClass("dashicons-hidden"))});a("#bulk_edit").live("click",function(){var b=a("#bulk-edit"),c=[];b.find("#bulk-titles").children().each(function(){c.push(a(this).attr("id").replace(/^(ttle)/i,""))});var d=[];a(".plans-checklist",b).find("input:checked").each(function(){d.push(a(this).val())});a.ajax({url:ajaxurl,type:"POST",
async:!1,cache:!1,data:{action:"yith_wcmbs_save_bulk_edit",post_ids:c,yith_wcmbs_restrict_access_plan:d}})});a("select.ajax_chosen_select_customer").on("yith_wcmbs_chosen_reset",function(){a(this).chosen("destroy");a(this).html("<option></option>");a(this).ajaxChosen({method:"GET",url:ajaxurl,dataType:"json",afterTypeDelay:100,minTermLength:1,data:{action:"woocommerce_json_search_customers",security:obj.customer_nonce}},function(b){var c={};a.each(b,function(a,b){c[a]=b});return c})}).trigger("yith_wcmbs_chosen_reset");
a(".yith-wcmbs-chosen-select-all").on("click",function(b){b=a(b.target).data("container-id");b=a("#"+b).find(".chosen").first();b.find("option").prop("selected",!0);b.trigger("chosen:updated")});a(".yith-wcmbs-chosen-deselect-all").on("click",function(b){b=a(b.target).data("container-id");b=a("#"+b).find(".chosen").first();b.find("option:selected").removeAttr("selected");b.trigger("chosen:updated")});a(document).on("click",".yith-wcmbs-copy-to-clipboard",function(b){b=a(this).data("selector-to-copy");
b=a(b);if(0<b.length){var c=a("<input>");a("body").append(c);c.val(b.html()).select();document.execCommand("copy");c.remove()}})});
