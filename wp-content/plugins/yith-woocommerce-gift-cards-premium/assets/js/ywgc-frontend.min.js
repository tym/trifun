jQuery(document).ready(function(a){function d(){return a(".ywgc-enter-code").slideToggle(400,function(){a(".ywgc-enter-code").find(":input:eq(0)").focus()}),!1}function e(b){a("div.ywgc-card-amount span.amount").text(b)}function f(b){a("button.gift_card_add_to_cart_button").attr("disabled",!b)}function g(){var b=a(".gift-cards-list select"),c=a("#give-as-present");if(!c.length){a(".gift-cards-list input.ywgc-manual-amount").addClass("ywgc-hidden"),a(".ywgc-manual-amount-error").remove();var d=0;if(0==b.length||"-1"==b.val()){var g=a(".gift-cards-list input.ywgc-manual-amount");if(g.length){var h=g.val();g.removeClass("ywgc-hidden");var i=new RegExp("^[1-9]\\d*(?:\\"+ywgc_data.currency_format_decimal_sep+"\\d{1,2})?$","g");h.length&&!i.test(h)?(g.after('<div class="ywgc-manual-amount-error">'+ywgc_data.manual_amount_wrong_format+"</div>"),f(!1)):h?(f(!0),d=h,d=accounting.unformat(d,ywgc_data.mon_decimal_point),d<=0?f(!1):(d=accounting.formatMoney(d,{symbol:ywgc_data.currency_format_symbol,decimal:ywgc_data.currency_format_decimal_sep,thousand:ywgc_data.currency_format_thousand_sep,precision:ywgc_data.currency_format_num_decimals,format:ywgc_data.currency_format}),f(!0))):f(!1)}}else b.val()?(f(!0),d=b.children("option:selected").text()):f(!1);e(d)}}function h(){var b=a("div.ywgc-single-recipient").last(),c='<div class="ywgc-single-recipient">            <input type="email" name="ywgc-recipient-email[]" class="ywgc-recipient"/>             <a href="#" class="ywgc-remove-recipient hide-if-alone">x</a>             </div>';b.after(c),a("a.ywgc-remove-recipient").css("visibility","visible"),a("div.gift_card_template_button input[name='quantity']").css("display","none"),a("div.gift_card_template_button div.multi-recipients").length||a("div.gift_card_template_button div.quantity").after("<div class='multi-recipients'><span>"+ywgc_data.multiple_recipient+"</span></div>")}function i(b){a(b).parent("div.ywgc-single-recipient").remove();var c=a('input[name="ywgc-recipient-email[]"');1==c.length&&(a("a.hide-if-alone").css("visibility","hidden"),a("div.gift_card_template_button input[name='quantity']").css("display","inherit"),a("div.multi-recipients").remove())}function j(b){a("div.ywgc-card-amount span.amount").text(b)}function k(b,c){var d=a(b).closest("div.ywgc-gift-card-content"),e=d.find("div.ywgc-gift-card-edit-details"),f=d.find("div.ywgc-gift-card-details");c?(e.removeClass("ywgc-hide"),e.addClass("ywgc-show"),f.removeClass("ywgc-show"),f.addClass("ywgc-hide")):(e.removeClass("ywgc-show"),e.addClass("ywgc-hide"),f.removeClass("ywgc-hide"),f.addClass("ywgc-show"))}function p(){l(a("div.cart_totals")),a.ajax({url:n("get_cart_totals"),dataType:"html",success:function(b){a("div.cart_totals").replaceWith(b)}})}var b=function(){jQuery().prettyPhoto&&a('[rel="prettyPhoto[ywgc-choose-design]"]').prettyPhoto({hook:"rel",social_tools:!1,theme:"pp_woocommerce",default_width:"80%",default_height:"100%",horizontal_padding:20,opacity:.8,deeplinking:!1,keyboard_shortcuts:!0,allow_resize:!1})},c=function(){a('input[name="ywgc-as-present-enabled"]').length&&(a(".ywgc-generator").hide(),f(!1))};b(),g(),c(),a(document).on("click",".ywgc-choose-image.ywgc-choose-template",function(a){b()}),a(document).on("click",".pp_content_container .ywgc-choose-preset",function(b){var c=a(this).data("design-id"),d=a(this).data("design-url");a("#ywgc-main-image").attr("src",d),a(document).trigger("ywgc-picture-changed",["template",c]),a.prettyPhoto.close()}),a(document).on("click","a.ywgc-show-category",function(b){var c=a(this).data("category-id");return a("a.ywgc-show-category").removeClass("ywgc-category-selected"),a(this).addClass("ywgc-category-selected"),"all"!==c?(a(".ywgc-design-item").hide(),a(".ywgc-design-item."+c).show()):a(".ywgc-design-item").show(),!1}),a(document).on("ywgc-picture-changed",function(b,c,d){a("#ywgc-design-type").val(c),a("#ywgc-template-design").val(d)}),a(document).on("click","a.ywgc-show-giftcard",d),a("button.ywgc-do-edit").css("display","inline"),a("div.ywgc-generator .datepicker").datepicker({dateFormat:"yy-mm-dd",minDate:1,maxDate:"+1Y"}),a(document).on("input",".gift-cards-list input.ywgc-manual-amount",function(a){g()}),a(document).on("click","a.add-recipient",function(a){a.preventDefault(),h()}),a(document).on("click","a.ywgc-remove-recipient",function(b){b.preventDefault(),i(a(this))}),a(document).on("input","#ywgc-edit-message",function(b){a(".ywgc-card-message").html(a("#ywgc-edit-message").val())}),a(document).on("change",".gift-cards-list select",function(a){g()}),a(document).on("click","a.customize-gift-card",function(b){b.preventDefault(),a("div.summary.entry-summary").after('<div class="ywgc-customizer"></div>')}),a(document).on("click",".ywgc-default-picture",function(b){b.preventDefault();var c=a("#ywgc-upload-picture");c.replaceWith(c=c.clone(!0)),a(".ywgc-main-image img.ywgc-main-image").attr("src",ywgc_data.default_gift_card_image),a(".ywgc-main-image").css("background-color",""),a("div.gift-card-too-small").remove(),a(document).trigger("ywgc-picture-changed",["default"])}),a(document).on("click",".ywgc-custom-picture",function(b){a("#ywgc-upload-picture").click()}),a("#ywgc-upload-picture").on("change",function(){var b=function(b){var c=new FileReader;c.readAsDataURL(b),c.onload=function(b){document.getElementById("ywgc-main-image").src=b.target.result,a(document).trigger("ywgc-picture-changed",["custom"]),a("#ywgc-main-image").width()<a(".ywgc-main-image").width()?(a(".ywgc-main-image").css("background-color","#ffe326"),a(".ywgc-preview").prepend('<div class="gift-card-too-small">'+ywgc_data.notify_custom_image_small+"</div>")):a(".ywgc-main-image").css("background-color","")}};a(".ywgc-picture-error").remove();var c=a(this).val().split(".").pop().toLowerCase();return a.inArray(c,["gif","png","jpg","jpeg","bmp"])==-1?void a("div.gift-card-content-editor.step-appearance").append('<span class="ywgc-picture-error">'+ywgc_data.invalid_image_extension+"</span>"):a(this)[0].files[0].size>1024*ywgc_data.custom_image_max_size*1024?void a("div.gift-card-content-editor.step-appearance").append('<span class="ywgc-picture-error">'+ywgc_data.invalid_image_size+"</span>"):void b(a(this)[0].files[0])}),a(document).on("click","#give-as-present",function(b){b.preventDefault(),a("div.ywgc-generator").append('<input type="hidden" name="ywgc-as-present" value="1">'),a("#give-as-present").css("visibility","hidden"),a("#ywgc-cancel-gift-card").css("visibility","visible"),a("div.ywgc-generator").css("display","inherit"),a("div.ywgc-generator").css("visibility","visible")}),a(document).on("click","#ywgc-cancel-gift-card",function(b){b.preventDefault(),a("div.ywgc-generator input[name='ywgc-as-present']").remove(),a("#give-as-present").css("visibility","visible"),a("#ywgc-cancel-gift-card").css("visibility","hidden"),a("div.ywgc-generator").css("display","none")}),a(document).on("change","#ywgc-postdated",function(b){a(this).is(":checked")?a("#ywgc-delivery-date").removeClass("ywgc-hidden"):a("#ywgc-delivery-date").addClass("ywgc-hidden")}),a(document).on("found_variation",function(){var b=a(".product .entry-summary .price .amount");b.length&&j(b.text())}),a(document).on("reset_data",function(){j("")}),a(document).on("click","button.ywgc-apply-edit",function(b){var c=a(this),d=c.closest("div.ywgc-gift-card-content"),e=d.find('input[name="ywgc-edit-sender"]').val(),f=d.find('input[name="ywgc-edit-recipient"]').val(),g=d.find('textarea[name="ywgc-edit-message"]').val(),h=d.find('input[name="ywgc-item-id"]').val(),i=d.find('input[name="ywgc-gift-card-id"]'),j=i.val();if(c.hasClass("apply")){var l={action:"edit_gift_card",gift_card_id:j,item_id:h,sender:e,recipient:f,message:g};d.block({message:null,overlayCSS:{background:"#fff url("+ywgc_data.loader+") no-repeat center",opacity:.6}}),a.post(ywgc_data.ajax_url,l,function(a){a.code>0&&(d.find("span.ywgc-sender").text(e),d.find("span.ywgc-recipient").text(f),d.find("span.ywgc-message").text(g),2==a.code&&i.val(a.values.new_id)),d.unblock(),k(c,!1)})}}),a(document).on("click","button.ywgc-cancel-edit",function(b){var c=a(this);k(c,!1)}),a(document).on("click","button.ywgc-do-edit",function(b){var c=a(this);k(c,!0)}),a(document).on("click","form.gift-cards_form button.gift_card_add_to_cart_button",function(b){a("div.gift-card-content-editor.step-content p.ywgc-filling-error").remove(),a("#ywgc-postdated").is(":checked")&&!a.datepicker.parseDate("yy-mm-dd",a("#ywgc-delivery-date").val())&&(a("div.gift-card-content-editor.step-content").append('<p class="ywgc-filling-error">'+ywgc_data.missing_scheduled_date+"</p>"),b.preventDefault())}),a(document).on("click",".ywgc-gift-card-content a.edit-details",function(b){b.preventDefault(),a(this).addClass("ywgc-hide"),a("div.ywgc-gift-card-details").toggleClass("ywgc-hide")}),a("form.ywgc-enter-code").submit(function(b){l(a(this));var c=a(this),d=c.find('input[name="coupon_code"]'),e=d.val(),f={security:ywgc_data.apply_coupon_nonce,is_gift_card:1,coupon_code:e};a.ajax({type:"POST",url:n("apply_coupon"),data:f,dataType:"html",success:function(b){o(b),a(document.body).trigger("applied_coupon")},complete:function(){m(c),d.val(""),p()}})});var l=function(a){a.addClass("processing").block({message:null,overlayCSS:{background:"#fff",opacity:.6}})},m=function(a){a.removeClass("processing").unblock()},n=function(a){return ywgc_data.wc_ajax_url.toString().replace("%%endpoint%%",a)},o=function(b,c){c||(c=a("table.shop_table.cart").closest("form")),a(".woocommerce-error, .woocommerce-message").remove(),c.before(b)};ywgc_data.enable_quick_view&&a(document).on("qv_loader_stop yit_quick_view_loaded flatsome_quickview",function(){g(),c()})});